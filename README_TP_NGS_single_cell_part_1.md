# TP NGS Single cell

The objective of the part of the TP NGS described in this document was to build an atlas of dental cell types in healthy mouse incisor based on single-cell mRNA sequencing data obtained with SmartSeq2. We will download these data and control their quality. Then we will align these cDNA sequences obtained with SmartSeq2 with a reference transcriptome of mus musculus cells to quantify the expression of genes in each single cell. Then we will ultimately build the atlas based on the transcription profiles of each cell through clustering analyses.

#Make a brief overview of the main scRNA-seq techniques, in particular Smart-seq2? Is our data single-end ? Paired-end ? (And when in the protocol will it matter?)

#Raw RNA-Seq data download 

First, access to the dataset which is publicly available on the GEO database using the accession code GSE146123. Select the samples of interest through these filters :
- Platform : smart_seq2
- Phenotype : healthy
- Organism : mus musculus
- source_name : incisor

Download the list of SRA identifiers (there is one for each single cell).

Download automatically the transcripts from the GEO database thanks to the list and transform them to fastq format with the fastq-dump tool.
First, we verify that the data are well extracted from the GO website and transformed on a first 10 cells with the bash script "**Data_download_script_test.sh**" in this GitHub. 

You should see the data from each single cell being downloaded as a transformed .fastq.gz file in your target directory (here sra_data).
If it works well, proceed and extract the transcripts from all the cells using the complete SRA list with the bash script "**Data_download_script.sh**" in this GitHub as well.


# Raw RNASeq data quality control

When the transcriptomic data of the 2555 cells are downloaded and transformed in your target directory allright, analyse their quality using the fastqc tool. It will outline, for each cells, the content in adapters, the overrepresented sequence (and try to identify them) or the %GC content in the transcriptome. This is mainly to verify that the data are not contaminated or odd in any way before aligning them with a reference transcriptome.
Use the FastQC tool on a few cells of your data set. The script "**Fast_qc.sh**" in this GitHub do it on the first 10 cells. Then, the quality results for these 10 cells can be visualized altogether using the MultiQC tool, which is at the end of this same script.


# Cleaning of the raw sequences 

A last step before using our sequences for alignment is to clean them of adaptors, sequences that are too short and will therefore not be aligned, and overrepresented sequences. We do it with the "**Clean_data_trimmomatic.sh**" bash script in this GitHub which uses the Trimmomatic tool. Trimmomatic erase from the sequences what has been aforementioned (adaptors, overrespresented sequences..), "trimming" or "cleaning" the data.

Check the efficiency of cleaning by verifying that all the features that we wanted like overrepresented sequences have been reduced by trimmomatic. For this, use FastQC and MultiQC tools on the first 10 cells of the clean data generated by trimmomatic. It is done through the "**Fast_qc_clean_data.sh**" bash scripts in this GitHub.
We can now compare the MultiQC reports to see the effect of trimmomatic on our data.


# M. musculus transcriptome download

Recover the M. musculus transcriptome from the ensembl database (https://www.ensembl.org/info/data/index.html). On "FTP site" in "Complete datasets and databases", we chose the latest relase (101) and all cDNA transcripts of mus musculus obtained with Fasta (ftp://ftp.ensembl.org/pub/release-101/fasta/mus_musculus/cdna/Mus_musculus.GRCm38.cdna.all.fa.gz)

This M.musculus reference transcriptome is downloaded in our machine automatically with the function wget.
Salmon is a tool that we will use for to map and quantify the transcripts data from our incisor's single cells. This tool, which is well adapted for SmartSeq2 data, need and index to map the transcript. We use the aforementioned mus musculus reference transcriptome that we define as the index for Salmon in the "**index.sh**" bash script in this GitHub (after automatic download of the reference transcriptome).

# Transcript expression quantification
Using Salmon, we then quantify the occurence of each cDNA transcript (identified from M.musculus reference transcriptome) in our SmartSeq2 mouse incisor single-cell transcriptomic data. We used the quantification function provided by Salmon on our cleaned data (post-trimmomatic). This function requires the index that we already established from the reference transcriptome. See the bash script "**quantif.sh**" in this GitHub. Here, Salmon generates a file for each cell containing the transcript identity of each read and their occurence.


# Realization of the dental atlas
In this second part, we will use these incisor single-cell transcriptomic data to generate an atlas of the cell types in mouse incisor based on gene expression profiles. 
This process if fully described in the "TP NGS single cell part 2.Rmd" file in this same GitHub.









